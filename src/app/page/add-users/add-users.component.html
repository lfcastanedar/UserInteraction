<div class="button-panel">
    <button class="btn btn-primary button-circle lift my-1" type="button" (click)="addUser()"><i
            class="fas fa-user-plus fa-2x"></i></button>
</div>

<div class="card shadow">
    <div class="card-body">
        <div class="text-center">
            <h3 style="color: #4e73df;">Instrucciones</h3>
            <p>Agrega y edita los sujetos procesales en el proceso</p>
            <img class="img-fluid" src="assets/img/agregar.jpg" alt="" srcset="">
        </div>

    </div>

</div>

<form [formGroup]="form" class="mt-3" #target>
    <div class="card shadow mb-1" formArrayName="people"
        *ngFor="let control of formArray.controls; index as indexGroup">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Persona #{{ indexGroup + 1}}</h6>
        </div>
        <div class="card-body">
            <div class="row mb-5" [formGroupName]="indexGroup">
                <div class="mb-3">
                    <h5 style="color: #4e73df; border-bottom: 3px solid #4e73df;">Información Basica</h5>
                </div>
                <div class="col-md-4">
                    <label for="first_name" class="form-label">Nombres</label>
                    <input type="text" class="form-control" id="first_name" formControlName="first_name">
                    <div class="form-text invalid-input"
                        *ngIf="control.get('first_name')?.hasError('required') && control.get('first_name')?.touched">
                        *Este
                        campo es obligatorio</div>
                </div>
                <div class="col-md-4">
                    <label for="last_name" class="form-label">Apellidos</label>
                    <input type="text" class="form-control" id="last_name" formControlName="last_name">
                    <div class="form-text invalid-input"
                        *ngIf="control.get('last_name')?.hasError('required') && control.get('last_name')?.touched">
                        *Este
                        campo es obligatorio</div>
                </div>
                <div class="col-md-4">
                    <label for="last_name" class="form-label">Tipo de Documento</label>
                    <select class="form-select" formControlName="document_type_id">
                        <option value="">Seleccione una opción</option>
                        <option *ngFor="let item of listOfDocumentTypes" value="{{ item.id }}">{{ item.name | titlecase
                            }}</option>
                    </select>
                </div>
                <div class="col-md-4 mt-1">
                    <label for="dni" class="form-label">Número de documento</label>
                    <input type="text" class="form-control" id="dni" formControlName="dni">
                </div>
                <div class="col-md-4 mt-1">
                    <label for="age" class="form-label">Edad</label>
                    <input type="number" class="form-control" id="age" formControlName="age">
                </div>
                <div class="col-md-4 mt-1">
                    <label for="displaced" class="form-label">Desplazado</label>
                    <label class="switch">
                        <input type="checkbox" id="displaced" formControlName="displaced">
                        <span class="slider round"></span>
                    </label>
                </div>
                <div class="col-md-4 mt-1">
                    <label for="occupation" class="form-label">Ocupación</label>
                    <input type="text" class="form-control" id="occupation" formControlName="occupation">
                </div>
                <div class="col-md-4 mt-1">
                    <label for="health_promoting_entity_id" class="form-label">EPS</label>
                    <select class="form-select" formControlName="health_promoting_entity_id">
                        <option value="">Seleccione una opción</option>
                        <option value="{{ data?.id }}" *ngFor="let data of listOfEPS">{{ data?.name }}</option>
                    </select>
                </div>
                <div class="mt-3 mb-2">
                    <h5 style="color: #4e73df; border-bottom: 3px solid #4e73df;">Tipo de Persona</h5>
                </div>
                <div class="col-md-4">
                    <label for="person_type_id" class="form-label">Tipo de Persona</label>
                    <select class="form-select" formControlName="person_type_id">
                        <option value="">Seleccione una opción</option>
                        <option value="{{ data?.id }}" *ngFor="let data of listOfPersonTypes"> {{ data?.name |
                            titlecase}}</option>

                    </select>
                    <div class="form-text invalid-input"
                        *ngIf="control.get('person_type_id')?.hasError('required') && control.get('person_type_id')?.touched">
                        *Este
                        campo es obligatorio</div>
                </div>
                <div class="col-md-4">
                    <label for="relationship_type_id" class="form-label">Parentesco con el Presunto Agresor</label>
                    <select class="form-select" formControlName="relationship_type_id">
                        <option value="">Seleccione una opción</option>
                        <option value="{{ data?.id }}" *ngFor="let data of listOfRelationshipses"> {{ data?.name |
                            titlecase}}</option>

                    </select>
                    <div class="form-text invalid-input"
                        *ngIf="control.get('relationship_type_id')?.hasError('required') && control.get('relationship_type_id')?.touched">
                        *Este
                        campo es obligatorio</div>
                </div>
                <div class="mt-3 mb-2">
                    <h5 style="color: #4e73df; border-bottom: 3px solid #4e73df;">Contacto</h5>
                </div>
                <div class="col-md-4 mt-1">
                    <label for="address" class="form-label">Dirección</label>
                    <input type="text" class="form-control" id="address" formControlName="address">
                    <div class="form-text invalid-input"
                        *ngIf="control.get('address')?.hasError('required') && control.get('address')?.touched">
                        *Este
                        campo es obligatorio</div>
                </div>
                <div class="col-md-4 mt-1">
                    <label for="neighborhood" class="form-label">Barrio</label>
                    <input type="text" class="form-control" id="neighborhood" formControlName="neighborhood">
                    <div class="form-text invalid-input"
                        *ngIf="control.get('neighborhood')?.hasError('required') && control.get('neighborhood')?.touched">
                        *Este
                        campo es obligatorio</div>
                </div>
                <div class="col-md-4 mt-1">
                    <label for="telephone" class="form-label">Telefóno</label>
                    <input type="text" class="form-control" id="telephone" formControlName="telephone">
                </div>
                <div class="col-md-4 mt-1">
                    <label for="mobile" class="form-label">Celular</label>
                    <input type="text" class="form-control" id="mobile" formControlName="mobile">
                </div>
                <div class="col-md-4 mt-1">
                    <label for="email" class="form-label">Correo electrónico</label>
                    <input type="email" class="form-control" id="email" formControlName="email">
                </div>
                <div class="col-md-4 mt-1">
                    <label for="" class="form-label">&nbsp;&nbsp; &nbsp; </label>
                    <div>
                        <div class="mx-1" style="display: inline-block;">
                            {{ control.get('id')?.value == '' ? 'No Registrado' : 'Registrado' }}
                        </div>
                        <button class="btn btn-info mx-1" type="button" (click)="clone(indexGroup)"><i
                                class="fas fa-clone"></i></button>
                        <button class="btn btn-danger mx-1" type="button" (click)="deleteUser(indexGroup)"><i
                                class="fas fa-user-minus"></i></button>
                        <app-loading-button class="btn btn-success mx-1" [type]="buttonTypes.icon"
                            [requestIsSending]="control.get('state')?.value" [icon]="'fas fa-save'"
                            (click)="submit(indexGroup)"></app-loading-button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>